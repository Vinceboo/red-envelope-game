# 2026 丙午马年红包工具 - 产品需求文档 (PRD)
**版本**: 1.0
**日期**: 2026-02-14
**代号**: prd0214

## 1. 产品概述
将现有的“红包H5小游戏”转型为一款功能完整的“红包分发工具”，专为 2026 马年春节设计。
**核心价值**：区别于普通的微信红包，本工具提供**高度可定制**、**视觉效果酷炫**、**交互感极强**的“拆红包”体验，特别适合家庭聚会、朋友派对等线下场景投屏或面对面分享使用。

## 2. 用户流程 (User Flows)

### 2.1. 发红包人流程 (设置与生成)
1.  **进入页面**：打开网页，默认进入**设置页**。
2.  **配置红包**：
    *   **红包数量**：拖动滑块或输入数字选择（范围：2-10个）。
    *   **金额分配模式**：
        *   *拼手气模式*：输入“总金额”（如 100元），系统随机分配给N个红包（支持精确到分）。
        *   *普通/自定义模式*：手动输入每个红包的具体金额（如：第一个52.00，第二个13.14，第三个88.88...）。
    *   **红包封面**：选择红包皮肤（如：“经典红金”、“马年限定”、“卡通可爱”）。
3.  **生成红包**：点击“塞钱进红包”按钮。
4.  **分发/预览**：自动跳转至**游戏界面**，等待大家来抽。

### 2.2. 抢红包人流程 (互动体验)
1.  **选红包**：界面展示出刚才配置好的 N 个 3D 红包，排列整齐。
2.  **拆红包**：
    *   用户点击选中一个红包。
    *   **长按开启**：按住“开”字按钮约 800毫秒（模拟蓄力）。
    *   *视觉反馈*：按钮发光、震动，金色进度条充满。
3.  **中奖结果**：
    *   红包炸开，粒子特效满屏。
    *   弹窗显示中奖金额。
    *   背景播放烟花动画。

## 3. 功能需求详情

### 3.1. 配置模块 (新增)
| ID | 功能点 | 详细描述 | 限制条件 |
| :--- | :--- | :--- | :--- |
| **C1** | **数量选择器** | 选择红包个数。 | 最小值: 2, 最大值: 10。 |
| **C2** | **拼手气模式** | 输入总金额，系统随机计算每个红包金额。 | 总金额 > 0。 |
| **C3** | **自定义模式** | 提供 N 个输入框，由用户手动填入每个金额。 | 输入框数量 = 选定的红包数。 |
| **C4** | **封面选择** | 左右切换或网格选择红包外观。 | 至少提供 2 种样式 (默认/马年)。 |
| **C5** | **流程导航** | “生成”按钮，校验通过后跳转至游戏页。 | - |

### 3.2. 游戏/交互模块 (优化现有)
| ID | 功能点 | 描述 | 状态 |
| :--- | :--- | :--- | :--- |
| **G1** | **红包网格展示** | 3D悬浮卡片展示，适配手机竖屏（双列滚动）。 | **已完成** |
| **G2** | **长按开启交互** | 交互式开红包，带震动和进度条反馈（去除了小马动画）。 | **已完成** |
| **G3** | **结果展示** | 弹窗显示金额，点击“再来一次”返回网格。 | **已完成** |
| **G4** | **返回配置** | 游戏页新增“返回设置”按钮，可重新调整金额或重置。 | **新增** |

### 3.3. 氛围与视觉
| ID | 功能点 | 描述 | 状态 |
| :--- | :--- | :--- | :--- |
| **V1** | **背景烟花** | 自动播放的随机烟花特效。 | **已完成** |
| **V2** | **点击金粉** | 全局点击触发金粉粒子爆炸效果。 | **已完成** |
| **V3** | **背景音乐** | 播放列表 (`bgm.mp3`, `bgm2.mp3`)，支持歌单选择。 | **已完成** |
| **V4** | **视觉主题** | 丙午马年主题文字/图标，Apple Design 风格（毛玻璃/流畅动画）。 | **已完成** |

## 4. 技术规格

### 4.1. 架构调整
*   **状态管理**：需要将红包数据 (`envelopes`) 和设置信息 (`settings`) 提升至全局状态（`App.jsx`），以便在“设置页”和“游戏页”之间切换时保持数据。
*   **路由/视图切换**：使用条件渲染 (`view === 'setup'` vs `view === 'game'`) 来切换大屏内容。

### 4.2. 核心算法
*   **二倍均值法 (类微信红包算法)**：
    *   输入：`总金额`, `剩余个数`。
    *   逻辑：保证每个人都能分到钱，且金额分布既有随机性又不过于悬殊（或者完全随机，看需求）。
    *   精度：保留两位小数。

## 5. 资源需求
*   **音频**：`bgm.mp3`, `bgm2.mp3`（已存在）。
*   **图片**：需要生成或引入新的红包封面素材。

## 6. 后续规划
*   **分享功能**：生成带参数的链接，分享给朋友直接发（暂不实现后端，仅做本地演示）。
*   **排行榜**：记录一局内谁是“手气王”。
